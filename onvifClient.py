from zeep import Client, Settings
from zeep.transports import Transport
from requests import Session
from requests.auth import HTTPDigestAuth
from zeep.exceptions import Fault, TransportError, XMLParseError

# from zeep.cache import SqliteCache
# cache = SqliteCache(path='./sqlite.db', timeout=60)

import os
wsdl_dir = os.path.abspath("wsdl")

SEC_PATH = f"file://{wsdl_dir}/advancedsecurity.wsdl"
DEV_PATH = f"file://{wsdl_dir}/devicemgmt.wsdl"

SEC_WSDL = SEC_PATH #'http://www.onvif.org/ver10/advancedsecurity/wsdl/advancedsecurity.wsdl'
SEC_BINDING = '{http://www.onvif.org/ver10/advancedsecurity/wsdl}AdvancedSecurityServiceBinding'
KEYSTORE_BINDING = '{http://www.onvif.org/ver10/advancedsecurity/wsdl}KeystoreBinding'
DOTX_BINDING = '{http://www.onvif.org/ver10/advancedsecurity/wsdl}Dot1XBinding'

DEV_WSDL = DEV_PATH #'http://www.onvif.org/ver10/device/wsdl/devicemgmt.wsdl'
DEV_BINDING = '{http://www.onvif.org/ver10/device/wsdl}DeviceBinding'

# older cert
#inter1
CERT_1 = '''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'''
#inter2
CERT_2 = '''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'''
# younger cert
CERT_3 = '''MIIFJDCCAwygAwIBAgIUHa4HIdr+KgS/yiybAG8pg3A1990wDQYJKoZIhvcNAQELBQAwgZIxCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxpZm9ybmlhMRYwFAYDVQQHDA1TYW4gRnJhbmNpc2NvMRMwEQYDVQQKDApNeSBDb21wYW55MRowGAYDVQQLDBFJbnRlcm1lZGlhdGUgQ0EgMjElMCMGA1UEAwwcTXkgQ29tcGFueSBJbnRlcm1lZGlhdGUgQ0EgMjAeFw0yNTEyMDUxMDIyNDNaFw0yNjEyMDUxMDIyNDNaMIGAMQswCQYDVQQGEwJVUzETMBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNU2FuIEZyYW5jaXNjbzETMBEGA1UECgwKTXkgQ29tcGFueTEVMBMGA1UECwwMV2ViIFNlcnZpY2VzMRgwFgYDVQQDDA93d3cuZXhhbXBsZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCtD+zvSO1XQr/BDUqkS+KYnbXlii9FjpcQzGMWnJ/LZQtjlHjxHSuRl25+eyyZ6TK6co/jPPF6F2Y5LCkXFvaNJLRpxd/rxC/11qZiq46pCTmTlCsVEIzmEv+fNYms2GnFJDvBG2EmzCYW8SMUmGFV7Y/R9XY99sKiIC5kvVbf7SKr6cEp/GqBqpNOXFY/ydhNieoTSZYmKmQsv2y+cNGxnEHYsvZ8BB+Hd4UPc3fVR/nFxB4o6M/JZVnJnPo0VaW6RqWj9dyeCqKOzBoE++eowUtHcMSbAxX7wxpKVg4770ocFrrz9AzkVGz40ieO2wBp9RySrRM9N2/i+b4yp7ehAgMBAAGjgYEwfzAdBgNVHQ4EFgQUV5dfib/2tvpX3OYhVgwknd/S7rIwCQYDVR0TBAIwADALBgNVHQ8EBAMCBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMCcGA1UdEQQgMB6CD3d3dy5leGFtcGxlLmNvbYILZXhhbXBsZS5jb20wDQYJKoZIhvcNAQELBQADggIBAAB24+phmRftfo9LxqY76ZYJINbXs4pRrBCvYLRC4SSHmt5UWFmMy6n16eXbtDCK22zc5TMKsl/xWl2wtZUKfQwAsXN/IaPUTUrObC/OJhpV1EMLWLzCaPXI1ZwPQhe5TChtblHdm70V68d6ZULnWNnhyYsIM6MXUoGaXYNmAKDTl3nhBeKPhB0PkOMeYXnaYoQwAD521jLNipyEj2S7g2dlTcRu0s72ZwAaM65DcM7ZJ46j9AWDQHvf3H6+WXd4luQwMs32juodLPU/YTQHQuCNOo4EMJDZwtVA3DvVSjW9U1QtBBuIvS4CfD6IdD1kZS9Glgfm2oN/pf0UBK3SxjyFZd57yNg9Xe55fEFdA8742i+jQhnyMcU9WbH9agssTDcxFMeUq8jVBM20TiRU4HjMU0SgKFlOAzUbQgVtLbmyNCrzMe3yMSw07T1eTVhDowHSqQsatN7dZh9kkpMHtzSWyz4eyPcww9vE4kvUqTG2kn5AdedPZtaFtAMEuZELp8sQNyax01Thw7GTXklVB4C2iUU3vkAWBM27zWPfQJxkzaGGx0yZkMXFQSyd0zUzf78fAoYKUOwSmHnR9AnFMpaSMpU6ImBo9xBTMKsvkbKB5S5C0Baw3SgQRg3JNtXWkSXbeCfRYV/jQp8svei64P6C1OoupksgQ5/hxSVOjn2+'''


VALID_CERT2 = '''MIICwTCCAakCFBOiKOKJ1sHs/CioQMsgUqiLR6yQMA0GCSqGSIb3DQEBCwUAMB4xCzAJBgNVBAYTAlJVMQ8wDQYDVQQDDAZpbnRlcjIwHhcNMjUxMjA1MDY0ODU5WhcNMjYxMjA1MDY0ODU5WjAcMQswCQYDVQQGEwJSVTENMAsGA1UEAwwEdXNlcjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOLf7oznRGuXcghjSmvtLC9fxXrXZXPNwIM4LP00BOFQyolkOMcahIImq136eY4T8Ofq86/IKyFJFu6gmWKEHDY7fn3jHOr32KR7Kv5f7LU3x70ktDdgEVjrc1Gbw4IyxfpSWAgCR0obGRrE9VHrJHMIu9dmcVpFaA3pZFz3pnXEG0R2y7B61b5JHOHOZHOddoJAZVZLXXs7rV8IK4NxfGmAS64YCsBtRlseww77VFKCCVoI6paxTY5gpHJ2Cp6k+v2xQxhpEOV6S/BHLGyy4vgw2yw0xdJcrPxun5WFSJggSWVleTHPsD14fNz9cCawQG17FL3NPzlZ/BScDR7X0JMCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAtYXr2N5jn4Ukmx4QbbEHOm0TxJE6dSyL2a9bIkqcHGCBq8DC5QjOsocA/tOW7ulU8+hvfgw9sV/FzyUtVa/CLnCNIswTT7SH7KtPlJCj6hmS+ESdMOMzO9ZJfrLXCQXk+BM1NHf5aHKT3t388w+gGr7C7+HR7VBeU0EgHb1kENdTNjemxPUY9Msud4ObTh5PjJHPLLuibt1+Ej3tzzBPsUz6IWzLaa28oiZfMPN3Y5zFDf7OKr+tDYOE6x8Izqw4JSz7FA9rNJMobFEd+H31BvgbW09jmXog+Jz0HrVNL4UABZeMMxHC60XDpF8JexalFS+ojME6Qc5IXwSjK+YEbA=='''
VALID_KEY2 = '''MIIEpQIBAAKCAQEA4t/ujOdEa5dyCGNKa+0sL1/Fetdlc83Agzgs/TQE4VDKiWQ4xxqEgiarXfp5jhPw5+rzr8grIUkW7qCZYoQcNjt+feMc6vfYpHsq/l/stTfHvSS0N2ARWOtzUZvDgjLF+lJYCAJHShsZGsT1Ueskcwi712ZxWkVoDelkXPemdcQbRHbLsHrVvkkc4c5kc512gkBlVktdezutXwgrg3F8aYBLrhgKwG1GWx7DDvtUUoIJWgjqlrFNjmCkcnYKnqT6/bFDGGkQ5XpL8EcsbLLi+DDbLDTF0lys/G6flYVImCBJZWV5Mc+wPXh83P1wJrBAbXsUvc0/OVn8FJwNHtfQkwIDAQABAoIBAQDOh6QVyQJUH43DbP/2t/WdOsX/Sc4lWYyC58Ssy4oVwwJdiErXlaBDCwi9iKLXX/fSZ+RmhQYeSvcBTFnVgQZdqFNCLlnI3M7vDODaqGBHp/vAh4U3U9D27YARLocQI0Bu3D8fK1PSdlCoOdxJMpH/1leJgsx1rPFImMqwhxGV6bTcac1USIjoj5UtirZPr/RXxe8mqKcShQzyMrHaaTowqVAMJ22a2qkaD1srclQcs7jHk3HRhzgqkR5TSCF8rUrwAzgFkH2+ZrwNsOjgPS72FMZVJIefDb3grp77OUnTPG+Hx2yPYu8HDxQwRhO1EFJ6DgK7nnubHwHrb+1EYYiBAoGBAPw/NE2b9IRTyfi/wKB5yRKWdF+TG3W6320czSKIlGXLC8Nw3QqgIK9MRAUNdhT1Et0JNB5X54QDJtlOLVKssjn6rbolnWk5cVps7GcO4+/0iE8UEw29CNySKBhyFnmbaE2Ir3YmT/gGvBQAswX/LkzqIV1jEbh06/bhbFyUW1+DAoGBAOZAFhT5+zMDlGHz4h5IPe5iN+KgFnX+EGxN+Ob5M+I+ZA1A2rQLvFPS5h3avaIHA7zbME9W1JfhhT4JDTDTwxvJQ91+nFZEq/S0KibV4N8xb4tHglB7zq/LE/J9qZcq9zz7LnMhZvnbd2EoHHeHWdLs/gpRX3rHrgDC24yMAG2xAoGBAO4p5wJX+7htPEeHFSLvme/Y6qvKw6SW+pmVFgJDHoo1+jdf+vQrWHDq+1Yh7ZnAAz17kSANM2SrbSTD8Xsb33Nqwlj9ZvCQ8fvE2Dg+EOzg30p607qm/xTzUrQyFBJhr0t1gOV3Kw4tnartNhq1Y0vvy+zWu0aD7r88/Ak1ckhtAoGAWYomjDXCmE4WEBmVn40ceG29qeXzliMdI+EWoEvc/2if4/+KjWXa8QYc8xMzl6T+sRzUJqZvuji7ZiqC9LAFOfME70fjaDEAZgMCOWQHNQS2igVfCgl7kSV6Nlzj7KOKzi4oHCGrOBM+04uTtm/uYHZFPKH0bXzlj+o3EusG56ECgYEA7KVMIkh+f17CcXRqk+QW5H/FJGVIuDojQClgdLh+d3lL93150jIynnptFfQQ5lTGgPVCOzi7YJicHs4knyLq25XpC6w2NZJaVxrjCsU1GNf5hJ3QSUV2N4QSEN5kg+qIJ7UQCyjk86YaQCWdz9KJ8ZKG3juiPvOdnFU084CXCwQ='''

VALID_KEY = '''MIIFLTBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQIqv7lr+SBkhwCAggAMAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBAGSYLM588mV2fgdn8PdsFkBIIE0DCj06trzCghBoPzCUo1C2WmL+L21Whv+Kt1nmUByvHPeUwfXnMoF14eQzSQ5RTcuNXCvkK2m5X0n2+ld1vWrhyLB5ld1+KUUcQDR99NmtE7PaazQ1fVsrvXn4vBpIZ5FJhh6MVuv5sjyucKKifQ2cLsFwbd23IvDe8WxtX9f/v39BqMKMNEAr7+epdMIzBOYtSH2WS3opNTgyDK/mtXYOFlxYPmWOhE2JQdjR6sgNFE9sGDFb+tu/PWQm2GZzA3a1FN+PvVIq5gb8U/4sOZojvAdD/AZTlDgIisoDVrVLEafFbQ1sGgnbEVXuJZFPQ61sbzIv7kNK+xtW+YK93eHKqSxmzu7HciU0YX6UAYIuQe1T3CQBzgV92psH22dFhecfVKhiBTVtnAelbzUTXkwpGfjMkQrZS0f3wgOMZpZchLYRZmYq2wllKZBDEwytiJcrQj1I825GV+Xfmj7e8OsTs9Zm8KtSSc4nLT8Qz5tsbw2cGnuNNYd1Bk+6uEN7uLmtIgGoMK42nyGCGYF3qaC3hdg4fwjz/pS1LiRmHgEpIwi44yPdtTrZY8hG+xaxTELMJA4946/Yjdk33UST2hOodsaSzbjjJe703X2XdR4vXLUIG6wOqacDwZBQkmww90tBic9y953O8MIgKv15ss5tUy8FsX131psGzAkfaItzEqQPoK5OHXNz2tDAQI4PZaAbPBYAQFY1Crv8W4+goR5d+MtHbpjqDr0+uTVJphn1GU5TL9wO5YKCmUO1pLDOSL7vy/aPRtKdIeO6plFE5N9YYMx91wGmfixpY9ydrzPx63C6Hi9YvRR1AkVpiB1HN7B+6/yGWcmZEijTpaQprySi/yBtsY8lFkeVWrENBwvT7ei8tF7zwz2zDkTlNKxxdJVOGRZ9AlCkfmulQgkM6jcfCEfMG4sdWiz38RI/i8/Ee8orrFq7UXbSInTfRb2xcrY+aOi8CdJrCnqwWNg5m9RCC2dDW/bCwM2YumEfCz6ld6ffLpZAcJVqxfLRdWF4IE7oB24IP2RvGpUloAX3wox9MGFrMZmjCHbLTQRz9pESELzc2nRtyTk3rFLuP7g30WCsUzrNNhp/DtNI3oA1EpcfUKRr4F5xBIE+80tyMkLJ/n6dtobG3gux5Wti0jQwRkqawz9cisRungtxDgQyVEOsKiSJjPE5F19HrdVmgb/iu1wKySNYuIkSGrlCjB0DKdlAJ+5R+ayZw69OQB58sryObt9rFzvGWaXpsZxVTrMuuywDqeQ6aQS81+Epu/jLYa6s8usJXndbNBmyuh0YzC2SiFKbaPqgKfhkl65q+uZKaAMfKzca+TGIAhDm4YKpAyNN4/dVkn0KtHlblaBwAYLV8C5bHBCFVirJib/MhY6NkJS/vi2bzu6L7kb9AypIDaz5WRTYbTA08ealVvyu5cpd8OgkbYhdbIwzGhFyooOxrAdu2tl65qXJTpnkwqqBNtTmxbMEMr4eqH4LC+fkts0aPjFDyi2zHsJ1bMnJWi7Fpy9rOGyYsDTnj2H8pyrhuCImvkMZMe+otWR8tqGDuhCMmlAFg9N+u/aND+yevDZGv8Idgjso0WUBygbK6QJRGlWb3PX51AewaQEByj4t8n8wfv8/3OWO3KYGSIbz877adN'''
VALID_PASS = '1234'
PUBLIC_KEY = '''MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3mwDqpmecO+OglzjgI8GIFPBjjpM6DsmWCr4A/8gRhg6yo+grGGFELiXhES8ph+q9QHTG1Y+pzg3/aHVNrEPrRgrPMn5o5UNxzQgoiZbuNIGh6oYuHPDq1cMJbPCzdf3MhoWOdiMCrf3YAIJOltD88GNayuzZXqDQoZ9MmJUlLZtPeAzIDZZNzQONlq8qVBplTweWAB6jLuxJP6nB3pvnLzyZXauUUDOQUMpxShPvNohmrTRJSEimnl/LfjO0bsxYOE/dDSxoSF2ikAR1AgQpl6Qo8anXF4wERWExaf9oiUsg6mDcaOlRgdG7zsPfgoemJtQXVrqWD+F3jxEQtr+ZQIDAQAB'''
VALID_NOCRYPT_KEY = '''MIIEpQIBAAKCAQEA4t/ujOdEa5dyCGNKa+0sL1/Fetdlc83Agzgs/TQE4VDKiWQ4xxqEgiarXfp5jhPw5+rzr8grIUkW7qCZYoQcNjt+feMc6vfYpHsq/l/stTfHvSS0N2ARWOtzUZvDgjLF+lJYCAJHShsZGsT1Ueskcwi712ZxWkVoDelkXPemdcQbRHbLsHrVvkkc4c5kc512gkBlVktdezutXwgrg3F8aYBLrhgKwG1GWx7DDvtUUoIJWgjqlrFNjmCkcnYKnqT6/bFDGGkQ5XpL8EcsbLLi+DDbLDTF0lys/G6flYVImCBJZWV5Mc+wPXh83P1wJrBAbXsUvc0/OVn8FJwNHtfQkwIDAQABAoIBAQDOh6QVyQJUH43DbP/2t/WdOsX/Sc4lWYyC58Ssy4oVwwJdiErXlaBDCwi9iKLXX/fSZ+RmhQYeSvcBTFnVgQZdqFNCLlnI3M7vDODaqGBHp/vAh4U3U9D27YARLocQI0Bu3D8fK1PSdlCoOdxJMpH/1leJgsx1rPFImMqwhxGV6bTcac1USIjoj5UtirZPr/RXxe8mqKcShQzyMrHaaTowqVAMJ22a2qkaD1srclQcs7jHk3HRhzgqkR5TSCF8rUrwAzgFkH2+ZrwNsOjgPS72FMZVJIefDb3grp77OUnTPG+Hx2yPYu8HDxQwRhO1EFJ6DgK7nnubHwHrb+1EYYiBAoGBAPw/NE2b9IRTyfi/wKB5yRKWdF+TG3W6320czSKIlGXLC8Nw3QqgIK9MRAUNdhT1Et0JNB5X54QDJtlOLVKssjn6rbolnWk5cVps7GcO4+/0iE8UEw29CNySKBhyFnmbaE2Ir3YmT/gGvBQAswX/LkzqIV1jEbh06/bhbFyUW1+DAoGBAOZAFhT5+zMDlGHz4h5IPe5iN+KgFnX+EGxN+Ob5M+I+ZA1A2rQLvFPS5h3avaIHA7zbME9W1JfhhT4JDTDTwxvJQ91+nFZEq/S0KibV4N8xb4tHglB7zq/LE/J9qZcq9zz7LnMhZvnbd2EoHHeHWdLs/gpRX3rHrgDC24yMAG2xAoGBAO4p5wJX+7htPEeHFSLvme/Y6qvKw6SW+pmVFgJDHoo1+jdf+vQrWHDq+1Yh7ZnAAz17kSANM2SrbSTD8Xsb33Nqwlj9ZvCQ8fvE2Dg+EOzg30p607qm/xTzUrQyFBJhr0t1gOV3Kw4tnartNhq1Y0vvy+zWu0aD7r88/Ak1ckhtAoGAWYomjDXCmE4WEBmVn40ceG29qeXzliMdI+EWoEvc/2if4/+KjWXa8QYc8xMzl6T+sRzUJqZvuji7ZiqC9LAFOfME70fjaDEAZgMCOWQHNQS2igVfCgl7kSV6Nlzj7KOKzi4oHCGrOBM+04uTtm/uYHZFPKH0bXzlj+o3EusG56ECgYEA7KVMIkh+f17CcXRqk+QW5H/FJGVIuDojQClgdLh+d3lL93150jIynnptFfQQ5lTGgPVCOzi7YJicHs4knyLq25XpC6w2NZJaVxrjCsU1GNf5hJ3QSUV2N4QSEN5kg+qIJ7UQCyjk86YaQCWdz9KJ8ZKG3juiPvOdnFU084CXCwQ='''

INVALID_ID = "INVALID"

class OnvifClient:
    def __init__(self, wsdl : str, user : str, pwd:str):
        self.session = Session()
        self.session.auth = HTTPDigestAuth(user, pwd)
        self.transport = Transport(session=self.session)#, cache=cache)
        self.client = Client(wsdl=wsdl, transport=self.transport)

    def createService(self, binding, endpoint):
        return self.client.create_service(binding, endpoint)